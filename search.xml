<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HCIA -- 10 -- 静态路由</title>
      <link href="/2023/09/02/HCIA-10-%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1/"/>
      <url>/2023/09/02/HCIA-10-%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1/</url>
      
        <content type="html"><![CDATA[<h1 id="一、路由的概念"><a href="#一、路由的概念" class="headerlink" title="一、路由的概念"></a>一、路由的概念</h1><ul><li>跨越从源主机到目标主剧的一个互联网络来转发数据包的过程</li><li>在转发过程中，负责路由数据包的机器，称之为路由器</li></ul><h1 id="二、路由器的工作原理"><a href="#二、路由器的工作原理" class="headerlink" title="二、路由器的工作原理"></a>二、路由器的工作原理</h1><ol><li>路由器与交换机相比，在转发数据时，唯一的相同点在于，都会查表转发【路由器：路由表；交换机：MAC 地址吧】</li><li>路由器与交换机在转发过程中的区别：<ol><li>交换机会学习源 MAC 地址，通过不断的学习源 MAC 地址来完整自身的 MAC地址表象；路由器不学习源 IP 地址，只关心目标网络。</li><li>交换机在无法找到目标网络时会进行广播转发操作，而路由器若没有找到路由表，则执行丢弃操作，向信源返回不可达信息。</li></ol></li></ol><h2 id="路由表"><a href="#路由表" class="headerlink" title="路由表"></a>路由表</h2><ul><li>在路由器中维护的路由条目，路由器根据路由表做路径选择。</li></ul><h2 id="直连路由"><a href="#直连路由" class="headerlink" title="直连路由"></a>直连路由</h2><ul><li>当在路由器上配置了借口的IP地址，并且接口状态为up的时候，路由表中就出现直连路由表项。</li></ul><h1 id="三、路由表的形成"><a href="#三、路由表的形成" class="headerlink" title="三、路由表的形成"></a>三、路由表的形成</h1><ol><li>路由器不学习源IP地址</li><li>路由器在配置好自身的接口IP地址后，首先会学习自身接口IP地址所属的网段，形成直连路由。</li><li>对于非直连的路由，其默认是不会出现在我的本地路由表中的，若想知道非直连的路由，则需要：<ol><li>静态路由：</li><li>动态路由：RIP、OSPF、IGRP、EIGRP、IS-IS、BGPv4</li></ol></li></ol><blockquote><p>注：在路由过程中，只有网络中的所有路由器的路由表完全一致了，该网络才能够正常转发数据。<br>若网络中的所有路由器的路由表完全一致后，该网络称之为【收敛】了。<br>只有收敛的网络才能够正常的转发数据<br>网络不收敛的状态称之为动荡状态｜抖动状态｜翻动状态</p></blockquote><h1 id="四、静态路由"><a href="#四、静态路由" class="headerlink" title="四、静态路由"></a>四、静态路由</h1><ul><li>静态路由是由管理员手动写在路由表中的，且为单向的。</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>Huawei<span class="token operator">></span>system-view<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route_static <span class="token number">172.16</span>.1.0 <span class="token number">24</span> <span class="token number">10.1</span>.1.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul><li>路由表是手工设置</li><li>除非网络管理员干预，否则静态路由不会发生变化</li><li>路由表的形成不需要占用网络资源</li><li>适用环境<ul><li>一般用于网络规模很小、拓扑结构固定的网络中</li></ul></li></ul><h1 id="五、缺省路由"><a href="#五、缺省路由" class="headerlink" title="五、缺省路由"></a>五、缺省路由</h1><ul><li>当路由器在自身的路由表中无法找到目标网络时，令路由器不要丢弃数据包，而是将数据包转发至一个默认的路由器上，这条路由器被称之为 —— 缺省路由</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>Huawei<span class="token operator">></span>system-view<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">0.0</span>.0.0 <span class="token number">0</span> <span class="token number">10.1</span>.1.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h2><ul><li>在所有路由类型中，默认路由的优先级最低</li><li>适用环境<ul><li>一般应用在只有一个出口的末端网络【Stub Area】</li><li>作为其它路由的补充出现</li></ul></li></ul><h1 id="六、路由器在转发数据包时的封装过程"><a href="#六、路由器在转发数据包时的封装过程" class="headerlink" title="六、路由器在转发数据包时的封装过程"></a>六、路由器在转发数据包时的封装过程</h1><ul><li>路由器在路由数据包时，三层头部中的源IP地址与目标IP地址始终保持不变，而路由器会不断的使用自身接口的MAC地址做二层重封装，将数据包一路路由至目的地。</li><li><code>结论：MAC地址的传输仅具有本地效应</code></li></ul><h1 id="七、单臂路由"><a href="#七、单臂路由" class="headerlink" title="七、单臂路由"></a>七、单臂路由</h1><ul><li>交换机上的VLAN之间如何通信</li></ul><h2 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h2><p><img src="/../../images/HCIA/%E5%8D%95%E8%87%82%E8%B7%AF%E7%94%B1/%E5%8D%95%E8%87%82%E8%B7%AF%E7%94%B1.png" alt="单臂路由"></p><p><strong>SW</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>SW<span class="token punctuation">]</span>vlan ba <span class="token number">2</span> <span class="token number">3</span><span class="token punctuation">[</span>SW-GigabitEthernet0/0/1<span class="token punctuation">]</span>port link-type access<span class="token punctuation">[</span>SW-GigabitEthernet0/0/1<span class="token punctuation">]</span>port default vlan <span class="token number">2</span><span class="token punctuation">[</span>SW-GigabitEthernet0/0/3<span class="token punctuation">]</span>port link-type access<span class="token punctuation">[</span>SW-GigabitEthernet0/0/3<span class="token punctuation">]</span>port default vlan <span class="token number">3</span><span class="token punctuation">[</span>SW-GigabitEthernet0/0/2<span class="token punctuation">]</span>port link-type trunk<span class="token comment">#放行vlan 2 3 标签</span><span class="token punctuation">[</span>SW-GigabitEthernet0/0/2<span class="token punctuation">]</span>port trunk allow-pass vlan <span class="token number">2</span> to <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>R1</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>R1<span class="token punctuation">]</span>int g0/0/0.1<span class="token comment">#dot1q termination vid</span><span class="token comment">#首先删除VLAN标签。接口在收到VLAN报文后，剥掉报文中携带的Tag后进行三层转发。</span><span class="token comment">#然后添加VLAN标签。接口在发送报文时，将相应的VLAN信息添加到报文中再发送。</span><span class="token punctuation">[</span>R1-GigabitEthernet0/0/0.1<span class="token punctuation">]</span>dot1q termination vid <span class="token number">2</span><span class="token punctuation">[</span>R1-GigabitEthernet0/0/0.1<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.1.1 <span class="token number">24</span><span class="token punctuation">[</span>R1-GigabitEthernet0/0/0.1<span class="token punctuation">]</span>arp broadcast <span class="token builtin class-name">enable</span>  <span class="token comment">#开启ARP广播功能</span><span class="token punctuation">[</span>R1-GigabitEthernet0/0/0.2<span class="token punctuation">]</span>dot1q termination vid <span class="token number">3</span><span class="token punctuation">[</span>R1-GigabitEthernet0/0/0.2<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.2.1 <span class="token number">24</span><span class="token punctuation">[</span>R1-GigabitEthernet0/0/0.2<span class="token punctuation">]</span>arp broadcast <span class="token builtin class-name">enable</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>测试连通性</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">PC<span class="token operator">></span>ping <span class="token number">192.168</span>.2.10Ping <span class="token number">192.168</span>.2.10: <span class="token number">32</span> data bytes, Press Ctrl_C to <span class="token builtin class-name">break</span>From <span class="token number">192.168</span>.2.10: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">32</span> <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">127</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">63</span> msFrom <span class="token number">192.168</span>.2.10: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">32</span> <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">127</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">78</span> msFrom <span class="token number">192.168</span>.2.10: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">32</span> <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">127</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">94</span> msFrom <span class="token number">192.168</span>.2.10: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">32</span> <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">4</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">127</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">78</span> msFrom <span class="token number">192.168</span>.2.10: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">32</span> <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">127</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">78</span> ms--- <span class="token number">192.168</span>.2.10 <span class="token function">ping</span> statistics ---  <span class="token number">5</span> packet<span class="token punctuation">(</span>s<span class="token punctuation">)</span> transmitted  <span class="token number">5</span> packet<span class="token punctuation">(</span>s<span class="token punctuation">)</span> received  <span class="token number">0.00</span>% packet loss  round-trip min/avg/max <span class="token operator">=</span> <span class="token number">63</span>/78/94 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> HICA </tag>
            
            <tag> 静态路由 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HCIA -- 9 -- 网络层</title>
      <link href="/2023/09/01/HCIA-9-%E7%BD%91%E7%BB%9C%E5%B1%82/"/>
      <url>/2023/09/01/HCIA-9-%E7%BD%91%E7%BB%9C%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<h2 id="一、网络层的主要功能"><a href="#一、网络层的主要功能" class="headerlink" title="一、网络层的主要功能"></a>一、网络层的主要功能</h2><ol><li>提供了通讯工程中必须要使用的另一个地址：逻辑 IP 地址【IPv4、IPv6】</li><li>连接不同的媒介类型【内网 — 外网(Intra — Inter)】</li><li>根据运行的不同路由协议，选择不同的最佳路径</li><li>在选择好的最佳路径上负责路由数据包</li></ol><h3 id="IP包头格式"><a href="#IP包头格式" class="headerlink" title="IP包头格式"></a>IP包头格式</h3><table style="text-align:center;width:700px"><tr style="background:rgb(238,133,109)">    <td>版本 (4)</td><td>首部长度 (4)</td><td>优先级与服务类型 (8)</td><td colspan="2">总长度 (16)</td><td rowspan="5" style="background:#fff">20 字节</td></tr><tr style="background:rgb(238,234,217)">    <td colspan="3">标识符 (16)</td><td>标志 (3)</td><td>段偏移量 (13)</td></tr><tr style="background:rgb(238,133,109,0.6)">    <td colspan="2">TTL (8)</td><td>协议号 (8)</td><td colspan="2">首部校验和 (16)</td></tr><tr style="background:rgb(238,234,217)">    <td colspan="5">源IP地址 (16)</td></tr><tr style="background:rgb(238,133,109,0.6)">    <td colspan="5">目标IP地址 (16)</td></tr><tr style="background:rgb(238,234,217)">    <td colspan="5">可选项</td><td rowspan="2" style="background:#fff"></td></tr><tr style="background:rgb(238,133,109,0.6)">    <td colspan="5">数据</td></tr></table><h2 id="QoS【服务质量】"><a href="#QoS【服务质量】" class="headerlink" title="QoS【服务质量】"></a>QoS【服务质量】</h2><p><code>分类、标记、流量调节、拥塞管理、拥塞避免</code></p><ol start="7"><li>网络协议保留使用</li><li>网络协议保留使用</li><li>音频流量</li><li>振铃流量</li><li>视频流量</li><li>高优先级</li><li>中优先级</li><li>BE【尽力而为】</li></ol><h2 id="二、网络层的IPv4头部"><a href="#二、网络层的IPv4头部" class="headerlink" title="二、网络层的IPv4头部"></a>二、网络层的IPv4头部</h2><p>网络层的 <code>IP</code> 头部默认为 <code>20Byte</code></p><ol><li>版本字段：用来表明当前IP协议所使用的版本号【IPv4】。</li><li>首部长度字段：用来表明当前IP头部一共多大【默认20Byte】。</li><li>服务类型与优先级：用来配合三层实现QoS使用。</li><li>总长度：包含各层头部封装与用户发送的原始数据的总大小。</li><li>标识符：</li><li>标志：在数据被分片之后，传送到对端，对端重组时保证不会乱序。</li><li>段偏移量：</li><li>TTL：网络中的每一个数据包默认都携带一TTL值，该值经过一个3层设备就减 1，当减至0时还没有被任何接收方接收，则该数据自动消失被丢弃，保证网络中不存在过多的垃圾文件。</li><li>协议号：三层与四层之间的服务接入点，若协议号为6，则表明上层使用的是TCP，若协议号为17，则表明上层使用的是UDP。</li><li>首部校验和：三层用来在首部进行校验和检测的地方。</li><li>源 IP 地址：32 bit</li><li>目的 IP 地址：32 bit</li></ol><h2 id="三、IP地址的作用"><a href="#三、IP地址的作用" class="headerlink" title="三、IP地址的作用"></a>三、IP地址的作用</h2><ol><li>一个IP地址可以用来标识一个独立的网络节点。</li><li>可以用来标识一个网段【组】。</li></ol><h2 id="四、IP地址的分类"><a href="#四、IP地址的分类" class="headerlink" title="四、IP地址的分类"></a>四、IP地址的分类</h2><ul><li>A：1 — 126 【通讯使用】</li><li>B：128 — 191 【通讯使用】</li><li>C：192 — 223 【通讯使用】</li><li>D：224 — 239 【组播使用】</li><li>E：240 — 254 【科学研究使用】</li></ul><p><code>注：127【本地回环接口地址】：用来实现本机网卡测试。</code><br><code>::1：IPv6 中的本地回环接口地址。</code></p><h2 id="五、私有地址"><a href="#五、私有地址" class="headerlink" title="五、私有地址"></a>五、私有地址</h2><ul><li>A：10.0.0.0&#x2F;8</li><li>B：172.16.0.0 — 172.31.255.255&#x2F;12</li><li>C：192.168.0.0 — 192.168.255.255&#x2F;16</li></ul><p>私有地址是网络从 <code>IPv4</code> 向 <code>IPv6</code> 过度种的过度技术，通过使用私有地址，能够明显的降低公有地址的消耗过度。<br>除了以上 3 段私有地址外，其他地址均为公有地址<br>注：<code>169.254.0.0/16 是微软买断的一个网段</code></p><h2 id="六、子网掩码的作用"><a href="#六、子网掩码的作用" class="headerlink" title="六、子网掩码的作用"></a>六、子网掩码的作用</h2><p>用来区分不同的网段</p><h2 id="七、子网的划分"><a href="#七、子网的划分" class="headerlink" title="七、子网的划分"></a>七、子网的划分</h2><ol><li>主机位不能全为 0，主机位全为 0 则表示的是网段</li><li>主机位不能全为 1，主机为全为 1 则表示的是广播地址</li></ol><h2 id="八、ARP-协议"><a href="#八、ARP-协议" class="headerlink" title="八、ARP 协议"></a>八、ARP 协议</h2><p>地址解析协议：已知对方的 <code>IP地址</code>，解析对方的 <code>MAC地址</code>。<br>客户端在与对端设备通讯时，首先检测自身的 <code>ARP缓存表</code>，若自身的 <code>ARP缓存表</code> 中不存在对端的 <code>IP</code> 与 <code>MAC地址</code> 的映射关系，则信源发送 <code>ARP广播请求</code>。<br>在信源发送的 <code>ARP广播请求</code> 中，包含了其自身的 <code>源IP地址</code> 与 <code>源MAC地址</code>，当对端设备接收到该 <code>ARP广播请求</code> 后，对端设备将会给予单播响应回复，而无需发送广播响应。<br>在信源得知了对端的 <code>MAC地址</code> 后，将对端设备 <code>IP地址</code> 与 <code>MAC地址</code> 做对应关系，保存在自身的 <code>ARP缓存表</code> 中后，方可与对端通讯。</p><h2 id="九、RARP-反向地址解析协议"><a href="#九、RARP-反向地址解析协议" class="headerlink" title="九、RARP 反向地址解析协议"></a>九、RARP 反向地址解析协议</h2><p>已知自身的 MAC地址，广播请求一个 IP地址<br>网络中的负责分配 IP地址 的服务器单薄给予响应，为客户端分配 IP地址</p><p><code>注：RARP就是DHCP的前身协议</code><br>RARP 因为需要让负责分配 <code>IP地址</code> 的服务器预先知道客户端的 <code>MAC地址</code> 后，才能给客户端分配 <code>IP地址</code>。</p><h2 id="十、代理-ARP"><a href="#十、代理-ARP" class="headerlink" title="十、代理 ARP"></a>十、代理 ARP</h2><ol><li>路由器默认情况下不会发送广播报文。</li><li>来自客户端的 <code>ARP广播请求</code> 不会被路由器传至对端。</li><li>路由器会将自身接口的 <code>IP地址</code> 与 <code>MAC地址</code> 以单播的方式响应给信源主机，信源主机的 <code>ARP缓存表</code> 中保存的就是直连路由器的接口 <code>IP地址</code> 与 <code>MAC地址</code> 的对应关系。</li><li>信源主机就会将所有访问目标网络的数据统一发送给自己的直连路由器。</li><li>路由器在两个客户端通讯的过程中，起到代理的作用。</li></ol><h2 id="十一、ICMP-【网际控制消息协议】"><a href="#十一、ICMP-【网际控制消息协议】" class="headerlink" title="十一、ICMP 【网际控制消息协议】"></a>十一、ICMP 【网际控制消息协议】</h2><ul><li>ICMP：用来检测网络的双向连通性。</li><li>ping [-t] [-a] [-l 字节数] IP_Address ｜ Target_names</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> HCIA </tag>
            
            <tag> 网络层 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HCIA -- 7 -- 聚合链路</title>
      <link href="/2023/08/31/HCIA-7-%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/"/>
      <url>/2023/08/31/HCIA-7-%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ul><li>链路聚合大多部署在核心层，以便提升整体网络的数据吞吐量。</li></ul><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul><li>链路聚合能够提高链路带宽、增强网络可用性、支持负载分担</li></ul><h2 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h2><ul><li>华为的网络设备共有两种链路聚合模式：<ul><li>手工负载分担模式：所有活动端口均可参与数据的转发，负载分担流量</li><li>LACP【Link Aggregation Control Protocol】模式：支持链路备份<br><img src="/../../images/HCIA/%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/%E6%A8%A1%E5%BC%8F.png" alt="模式"></li></ul></li></ul><h2 id="指导原则"><a href="#指导原则" class="headerlink" title="指导原则"></a>指导原则</h2><ol><li>华为网络设备最多允许 <strong>8个端口</strong> 绑定刀一起</li><li>一个 <strong>Eth-Trunk</strong> 内的所有端口必须使用 <strong>相同模式</strong>【手工或LACP】</li><li>一个 <strong>Eth-Trunk</strong> 内的所有端口都必须具有 <strong>相同的速率和双工模式</strong>；若成员端口的速率不同，速率较低的端口可能会拥塞，报文可能会被丢弃</li><li>一个端口不能在 <strong>相同时间</strong> 内属于 <strong>多个通道组</strong></li><li>一个 <strong>Eth-Trunk</strong> 内的所有端口都必须配置到 <strong>相同的接入VLAN或VLAN干道中</strong></li><li>只能删除不包含任何成员端口的 Eth-Trunk 口</li><li>将端口加入进 Eth-Trunk 口时，二层 Eth-Trunk 口的成员端口必须是二层端口，三层 Eth-Trunk 口的成员端口必须时三层端口</li><li>加入 Eth-Trunk 口的端口必须是 <strong>hybrid端口</strong></li><li>一个 Eth-Trunk 口不能充当其它 Eth-Trunk 口的成员端口</li><li>一个 Eth-Trunk 口的成员端口类型必须相同；一个快速以太网端口【FastEthernet】与一个千兆以太网端口【GigabitEthernet】不能加入同一个 Eth-Trunk 内</li><li>端口加入到 Eth-Trunk 后，Eth-Trunk 端口将会<strong>学习</strong> <code>MAC地址</code>，而成员端口不在学习 <code>MAC地址</code></li></ol><p><code>注：二层交换机只能和二层交换机做链路聚合，三层交换机只能和三层交换机做链路聚合。</code></p><h2 id="数据流控制"><a href="#数据流控制" class="headerlink" title="数据流控制"></a>数据流控制</h2><ul><li>数据流在聚合链路上传输，数据顺序必须保持不变。一个数据流可以看做是一组 MAC地址 和 IP地址 相同的帧。</li><li>配置链路聚合后，多条物理链路被绑定成一条聚合链路，一个数据流中的帧通过不同的物理链路传输，从而产生接受数据包乱序的情况。</li><li>为了避免这种情况的发生，Eth-Trunk 采用逐流负载分担的机制</li><li>将数据帧中的地址通过 HASH 算法生成 HASH-KEY 值，根据该数值在 Eth-Trunk 转发表中寻找对应的出接口，不同的 MAC地址 或 IP地址 HASH 得出的 HASH-KEY 值不同，从而出接口也就不同。</li><li>保证了同一数据流的帧在同一条物理链路转发，又实现了流量在聚合组内各物理链路上的负载分担，即逐流的负载分担。</li><li>逐流负载分担能保证包的顺序，但不能保证贷款利用率。</li></ul><h2 id="均分负载"><a href="#均分负载" class="headerlink" title="均分负载"></a>均分负载</h2><ul><li>等价均分负载 — 将流量均匀地分布到多条度量相同的路径上，又叫负载平衡。</li><li>非等价均分负载 — 将数据包分布到度量不同的多条路径上，各条路径上分布的流量与路由代价成反比，代价越低的路径分配的流量越多，代价越高的路径分配的流量越少。</li><li>一些路由选择协议可以支持等价和非等价负载均衡两种方式，如 EIGRP；而一些路由选择协议仅支持等价方式，静态路由没有度量，因此仅支持等价负载均衡。</li></ul><h1 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h1><h2 id="二层链路手工模式聚合配置"><a href="#二层链路手工模式聚合配置" class="headerlink" title="二层链路手工模式聚合配置"></a>二层链路手工模式聚合配置</h2><p><img src="/../../images/HCIA/%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/%E4%BA%8C%E5%B1%82-%E8%81%9A%E5%90%88%E9%93%BE%E8%B7%AF.png" alt="二层-链路聚合"></p><p><strong>SW1</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Eth-Trunk1<span class="token punctuation">]</span>q<span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>int e0/0/1<span class="token punctuation">[</span>SW1-Ethernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Ethernet0/0/1<span class="token punctuation">]</span>int e0/0/2<span class="token punctuation">[</span>SW1-Ethernet0/0/2<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Ethernet0/0/2<span class="token punctuation">]</span>int e0/0/3<span class="token punctuation">[</span>SW1-Ethernet0/0/3<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>dis <span class="token function">ip</span> int br*down: administratively down^down: standby<span class="token punctuation">(</span>l<span class="token punctuation">)</span>: loopback<span class="token punctuation">(</span>s<span class="token punctuation">)</span>: spoofingThe number of interface that is UP <span class="token keyword">in</span> Physical is <span class="token number">2</span>The number of interface that is DOWN <span class="token keyword">in</span> Physical is <span class="token number">1</span>The number of interface that is UP <span class="token keyword">in</span> Protocol is <span class="token number">1</span>The number of interface that is DOWN <span class="token keyword">in</span> Protocol is <span class="token number">2</span>Interface                         IP Address/Mask      Physical   Protocol  MEth0/0/1                         unassigned           down       down      NULL0                             unassigned           up         up<span class="token punctuation">(</span>s<span class="token punctuation">)</span>     Vlanif1                           unassigned           up         down      <span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>dis eth-trunk <span class="token number">1</span>Eth-Trunk1's state information is:WorkingMode: NORMAL         Hash arithmetic: According to SIP-XOR-DIP         Least Active-linknumber: <span class="token number">1</span>  Max Bandwidth-affected-linknumber: <span class="token number">8</span>              Operate status: up          Number Of Up Port In Trunk: <span class="token number">3</span>                     --------------------------------------------------------------------------PortName                      Status      Weight Ethernet0/0/1                 Up          <span class="token number">1</span>      Ethernet0/0/2                 Up          <span class="token number">1</span>      Ethernet0/0/3                 Up          <span class="token number">1</span>   <span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>dis stp br MSTID  Port                        Role  STP State     Protection   <span class="token number">0</span>    Ethernet0/0/4               DESI  FORWARDING      NONE   <span class="token number">0</span>    Eth-Trunk1                  ROOT  FORWARDING      NONE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>SW2</strong><br>sw2配置与sw1相同</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>SW2<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Eth-Trunk1<span class="token punctuation">]</span>int e0/0/1<span class="token punctuation">[</span>SW2-Ethernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Ethernet0/0/1<span class="token punctuation">]</span>int e0/0/2<span class="token punctuation">[</span>SW2-Ethernet0/0/2<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Ethernet0/0/2<span class="token punctuation">]</span>int e0/0/3<span class="token punctuation">[</span>SW2-Ethernet0/0/3<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="LACP"><a href="#LACP" class="headerlink" title="LACP"></a>LACP</h2><p><strong>SW1</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Eth-Trunk1<span class="token punctuation">]</span>mode lacp-static  <span class="token comment">#配置模式</span><span class="token punctuation">[</span>SW1-Ethernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Ethernet0/0/1<span class="token punctuation">]</span>int e0/0/2<span class="token punctuation">[</span>SW1-Ethernet0/0/2<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Ethernet0/0/2<span class="token punctuation">]</span>int e0/0/3<span class="token punctuation">[</span>SW1-Ethernet0/0/3<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>lacp priority <span class="token number">100</span>  <span class="token comment">#选举指定lacp优先级</span><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>int e0/0/1<span class="token punctuation">[</span>SW1-Ethernet0/0/1<span class="token punctuation">]</span>lacp priority <span class="token number">100</span>  <span class="token comment">#配置优先级</span><span class="token punctuation">[</span>SW1-Ethernet0/0/1<span class="token punctuation">]</span>int e0/0/2<span class="token punctuation">[</span>SW1-Ethernet0/0/2<span class="token punctuation">]</span>lacp priority <span class="token number">100</span><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>SW1-Eth-Trunk1<span class="token punctuation">]</span>max active-linknumber <span class="token number">2</span>  <span class="token comment">#指定最大活跃链路为两条</span><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>dis eth-trunk <span class="token number">1</span>Eth-Trunk1<span class="token string">'s state information is:Local:LAG ID: 1                   WorkingMode: STATIC                               Preempt Delay: Disabled     Hash arithmetic: According to SIP-XOR-DIP         System Priority: 100        System ID: 4c1f-cc82-4664                         Least Active-linknumber: 1  Max Active-linknumber: 2                          Operate status: down        Number Of Up Port In Trunk: 0                     --------------------------------------------------------------------------------ActorPortName          Status   PortType PortPri PortNo PortKey PortState WeightEthernet0/0/1          Unselect 100M     100     2      289     10100010  1     Ethernet0/0/2          Unselect 100M     100     3      289     10100010  1     Ethernet0/0/3          Unselect 100M     32768   4      289     10100010  1     Partner:--------------------------------------------------------------------------------ActorPortName          SysPri   SystemID        PortPri PortNo PortKey PortStateEthernet0/0/1          0        0000-0000-0000  0       0      0       10100011Ethernet0/0/2          0        0000-0000-0000  0       0      0       10100011Ethernet0/0/3          0        0000-0000-0000  0       0      0       10100011'</span><span class="token punctuation">[</span>SW1<span class="token punctuation">]</span>dis stp br MSTID  Port                        Role  STP State     Protection   <span class="token number">0</span>    Ethernet0/0/4               DESI  FORWARDING      NONE   <span class="token number">0</span>    Eth-Trunk1                  ROOT  FORWARDING      NONE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>SW2</strong><br>sw2配置与sw1相同</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>SW2<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Eth-Trunk1<span class="token punctuation">]</span>mode lacp-static<span class="token punctuation">[</span>SW2-Eth-Trunk1<span class="token punctuation">]</span>int e0/0/1<span class="token punctuation">[</span>SW2-Ethernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Ethernet0/0/1<span class="token punctuation">]</span>int e0/0/2<span class="token punctuation">[</span>SW2-Ethernet0/0/2<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Ethernet0/0/2<span class="token punctuation">]</span>int e0/0/3<span class="token punctuation">[</span>SW2-Ethernet0/0/3<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2<span class="token punctuation">]</span>lacp priority <span class="token number">100</span><span class="token punctuation">[</span>SW2<span class="token punctuation">]</span>int e0/0/1<span class="token punctuation">[</span>SW2-Ethernet0/0/1<span class="token punctuation">]</span>lacp priority <span class="token number">100</span><span class="token punctuation">[</span>SW2-Ethernet0/0/1<span class="token punctuation">]</span>int e0/0/2<span class="token punctuation">[</span>SW2-Ethernet0/0/2<span class="token punctuation">]</span>lacp priority <span class="token number">100</span><span class="token punctuation">[</span>SW2<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>SW2-Eth-Trunk1<span class="token punctuation">]</span>max active-linknumber <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="三层链路手工模式聚合配置"><a href="#三层链路手工模式聚合配置" class="headerlink" title="三层链路手工模式聚合配置"></a>三层链路手工模式聚合配置</h2><p><img src="/../../images/HCIA/%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/%E4%B8%89%E5%B1%82-%E8%81%9A%E5%90%88%E9%93%BE%E8%B7%AF.png" alt="三层-链路聚合"></p><p><strong>AR1</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>AR1<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>AR1<span class="token punctuation">]</span> int g0/0/0<span class="token punctuation">[</span>AR1-GigabitEthernet0/0/0<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span>Info: This operation may take a few seconds. Please <span class="token function">wait</span> <span class="token keyword">for</span> a moment<span class="token punctuation">..</span>.Error: The layer-3 interface can not <span class="token function">add</span> into a layer-2 trunk.done.<span class="token punctuation">[</span>AR1<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>AR1-Eth-Trunk1<span class="token punctuation">]</span>undo portswitch  <span class="token comment">#关闭二层端口功能</span><span class="token punctuation">[</span>AR1-Eth-Trunk1<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.1.1 <span class="token number">24</span><span class="token punctuation">[</span>AR1-GigabitEthernet0/0/0<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>AR1-GigabitEthernet0/0/0<span class="token punctuation">]</span>int g0/0/1<span class="token punctuation">[</span>AR1-GigabitEthernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token comment">#测试连通性</span><span class="token punctuation">[</span>AR1<span class="token punctuation">]</span>ping <span class="token number">192.168</span>.1.2  PING <span class="token number">192.168</span>.1.2: <span class="token number">56</span>  data bytes, press CTRL_C to <span class="token builtin class-name">break</span>    Reply from <span class="token number">192.168</span>.1.2: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">56</span> <span class="token assign-left variable">Sequence</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">255</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">90</span> ms    Reply from <span class="token number">192.168</span>.1.2: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">56</span> <span class="token assign-left variable">Sequence</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">255</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">10</span> ms    Reply from <span class="token number">192.168</span>.1.2: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">56</span> <span class="token assign-left variable">Sequence</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">255</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">20</span> ms    Reply from <span class="token number">192.168</span>.1.2: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">56</span> <span class="token assign-left variable">Sequence</span><span class="token operator">=</span><span class="token number">4</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">255</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">30</span> ms    Reply from <span class="token number">192.168</span>.1.2: <span class="token assign-left variable">bytes</span><span class="token operator">=</span><span class="token number">56</span> <span class="token assign-left variable">Sequence</span><span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">255</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">10</span> ms  --- <span class="token number">192.168</span>.1.2 <span class="token function">ping</span> statistics ---    <span class="token number">5</span> packet<span class="token punctuation">(</span>s<span class="token punctuation">)</span> transmitted    <span class="token number">5</span> packet<span class="token punctuation">(</span>s<span class="token punctuation">)</span> received    <span class="token number">0.00</span>% packet loss    round-trip min/avg/max <span class="token operator">=</span> <span class="token number">10</span>/32/90 ms<span class="token punctuation">[</span>AR1<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>AR1-Eth-Trunk1<span class="token punctuation">]</span>mode lacp-static <span class="token punctuation">[</span>AR1<span class="token punctuation">]</span>dis int Eth-Trunk <span class="token number">1</span>Eth-Trunk1 current state <span class="token builtin class-name">:</span> UPLine protocol current state <span class="token builtin class-name">:</span> UP······-----------------------------------------------------PortName                      Status      Weight-----------------------------------------------------GigabitEthernet0/0/0          UP          <span class="token number">1</span>GigabitEthernet0/0/1          UP          <span class="token number">1</span>-----------------------------------------------------The Number of Ports <span class="token keyword">in</span> Trunk <span class="token builtin class-name">:</span> <span class="token number">2</span>The Number of UP Ports <span class="token keyword">in</span> Trunk <span class="token builtin class-name">:</span> <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>AR2</strong><br>AR2配置与AR1相同</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>AR2<span class="token punctuation">]</span>int Eth-Trunk <span class="token number">1</span><span class="token punctuation">[</span>AR2-Eth-Trunk1<span class="token punctuation">]</span>undo portswitch<span class="token punctuation">[</span>AR2-Eth-Trunk1<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.1.2<span class="token punctuation">[</span>AR2-GigabitEthernet0/0/0<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span class="token punctuation">[</span>AR2-GigabitEthernet0/0/0<span class="token punctuation">]</span>int g0/0/1<span class="token punctuation">[</span>AR2-GigabitEthernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> HCIA </tag>
            
            <tag> 聚合链路 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HCIA -- 6 -- STP</title>
      <link href="/2023/08/30/HCIA-6-STP/"/>
      <url>/2023/08/30/HCIA-6-STP/</url>
      
        <content type="html"><![CDATA[<h2 id="一、二层广播风暴的产生"><a href="#一、二层广播风暴的产生" class="headerlink" title="一、二层广播风暴的产生"></a>一、二层广播风暴的产生</h2><ol><li>交换机的工作原理中存在缺陷，交换机在无法找到目标网络时会发送广播。</li><li>弱管理员将网络的物理拓扑结构连接成环路的话，则在二层网络中，将会引起广播风暴。</li><li>广播风暴会导致交换机耗尽自身全部资源，致使硬件设备死机或硬件损坏。</li></ol><h2 id="二、STP的工作原理"><a href="#二、STP的工作原理" class="headerlink" title="二、STP的工作原理"></a>二、STP的工作原理</h2><ol><li>STP将一个有环网络中的某一条链路的某一个端口从逻辑上down掉，保证网络无环且正常运行；当其他任意一条主链路发生故障时，之前从逻辑上down掉的端口会自动激活，重新恢复连接，保证通讯的正常运行。</li></ol><h3 id="2-STP的算法"><a href="#2-STP的算法" class="headerlink" title="2. STP的算法"></a>2. STP的算法</h3><p>STP若想将一个有环的网络最终生成为一个无环的拓扑结构，一共需要 3 步：</p><h4 id="2-1-选择根网桥【root】"><a href="#2-1-选择根网桥【root】" class="headerlink" title="2.1 选择根网桥【root】"></a>2.1 选择根网桥【root】</h4><p>每台交换机都有一个独立且唯一的BID【Bridge ID】<br>BID &#x3D; <code>网桥优先级</code> ➕ <code>网桥 MAC 地址</code><br>网桥的优先级取值范围：<code>0 —— 61440</code><br>默认值为：<code>32768</code><br>在选择根网桥时，BID最小的将胜出。<br>因此在进行选举时，各个网桥先比较各自的优先级值，若优先级值完全一样时，再比较各个网桥的 MAC 地址。<br><code>注：在手动配置 STP 的优先级时，改值必须能够被 2 整除，且是 16 的整数倍；管理员能够配置的最小值为4096</code><br>STP配置优先级时的常用数值：<code>4096、8192、24576、32768</code></p><h4 id="2-2-选择根端口【RP】"><a href="#2-2-选择根端口【RP】" class="headerlink" title="2.2 选择根端口【RP】"></a>2.2 选择根端口【RP】</h4><p>根端口时在非根网桥上选举出来的，在非根网桥上选择根端口，共需4步：</p><ol><li>最低的到达根网桥的路径开销</li><li>最低的发送方网桥ID</li><li>最低的端口优先级</li><li>发送方最低的端口ID</li></ol><p><code>注：端口ID【Port ID】</code></p><p>PID &#x3D; <code>端口优先级</code> ➕ <code>端口编号</code><br>端口优先级的取值范围：<code>0 — 240</code><br><code>默认值为：128</code><br>端口编号：E0&#x2F;0&#x2F;1【左起第一个 0 表示板卡号、中间的 0 表示模块号、最右侧的 1 表示槽位号（端口编号）】<br>E0&#x2F;0&#x2F;1 的 PID &#x3D; 128.1</p><h4 id="2-3-选择指定端口【DP】"><a href="#2-3-选择指定端口【DP】" class="headerlink" title="2.3 选择指定端口【DP】"></a>2.3 选择指定端口【DP】</h4><ul><li>在每个网段上，选择1个指定端口</li><li>根网桥上的所有端口均为指定端口</li><li>非根网桥上指定端口选举的过程分为4步：<ol><li>BPDU 中的根网桥 ID</li><li>最低的到达根网桥的路径开销</li><li>发送方的网桥 ID</li><li>若优先级相同，则具有最低 MAC 地址</li></ol></li></ul><h3 id="3-BPDU-【Bridge-Protocol-Data-Unit-｜-桥接协议数据单元】"><a href="#3-BPDU-【Bridge-Protocol-Data-Unit-｜-桥接协议数据单元】" class="headerlink" title="3 BPDU 【Bridge Protocol Data Unit ｜ 桥接协议数据单元】"></a>3 BPDU 【Bridge Protocol Data Unit ｜ 桥接协议数据单元】</h3><ol><li>各个交换机使用 BPDU 来交换 STP 中要使用的信息</li><li>BPDU 使用组播方式传递，使用的组播地址为：<code>01-80-C2-00-00-00</code></li><li>BPDU的种类<ol><li>配置BPDU【Configuration BPDU】：用来实现 STP 的首次计算</li><li>拓扑变更通告【TCN】BPDU：用来在STP发生变化的时候使用</li></ol></li></ol><h2 id="三-STP的5种端口状态"><a href="#三-STP的5种端口状态" class="headerlink" title="三. STP的5种端口状态"></a>三. STP的5种端口状态</h2><ol><li>禁用[Disable]：不发送 BPDU， 不接受 BPDU，不学习 MAC 地址，不会转发数据。</li><li>阻塞[Discarding]：不发送 BPDU，<strong>接受 BPDU</strong>，不学习 MAC 地址，不会转发数据。</li><li>侦听[Listening]：<strong>发送 BPDU，接受 BPDU</strong>， 不学习 MAC 地址，不会转发数据<span style="color:red">【中间态】</span>。</li><li>学习[Learning]：<strong>发送 BPDU，接受 BPDU，学习 MAC 地址</strong>，不会转发数据<span style="color:red">【中间态】</span>。</li><li>转发[Forwarding]：<strong>发送 BPDU，接受 BPDU，学习 MAC 地址，转发数据。</strong></li></ol><h2 id="四-STP的拓扑结构变化"><a href="#四-STP的拓扑结构变化" class="headerlink" title="四. STP的拓扑结构变化"></a>四. STP的拓扑结构变化</h2><ol><li>在生成树中，一个阻塞状态的端口从阻塞状态最终恢复至转发状态，一共需要 <span style="color:red;">50s</span>。</li><li>Discarding 进入 Listening 需要 <span style="color:red;">20s</span> 【Maxage：最大老化时间】。</li><li>Listening 进入 Learning 需要 <span style="color:red;">15s</span>。</li><li>Learning 进入 Forwarding 需要 <span style="color:red;">15s</span> 【15s + 15s &#x3D; 30s Forwarding Dealy ：转发延迟】。</li><li>若是非直连链路，端口恢复需要 50s。</li><li>若是直连链路，只需 30s 【节省了 20s 的 maxage】。</li><li>交换机的 MAC 地址表默认 300s maxage，当STP的拓扑结构发生变化时，STP的TCN BPDU 会立即通知交换机的 MAC 地址表立即刷新，令交换机的 MAC 地址表的刷新时间从 300s 变为 15s 。</li></ol><h2 id="五-STP的配置"><a href="#五-STP的配置" class="headerlink" title="五. STP的配置"></a>五. STP的配置</h2><ol><li>在华为的交换机上，STP技术默认随着设备的启动而自动运行。</li><li>更改交换机的优先级</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stp priority 4096</span><br></pre></td></tr></table></figure><ol start="3"><li>更改当前交换机的STP模式</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stp mode stp</span><br></pre></td></tr></table></figure><ol start="4"><li>更改STP的路径计算方式</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stp pathcost-standard dotld-1998</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> HCIA </tag>
            
            <tag> STP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>部署hexo到github上</title>
      <link href="/2023/08/24/hexo%E9%83%A8%E7%BD%B2/"/>
      <url>/2023/08/24/hexo%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<ul><li>准备工作：<ul><li>git账号</li><li>本地安装git、nodejs(建议12.0以上)</li></ul></li></ul><p>官方文档 <a href="https://hexo.io/zh-cn/">https://hexo.io/zh-cn/</a></p><h2 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h2><p>下载<a href="https://nodejs.org/en/download/releases">node.js</a></p><p><img src="/../../images/hexo%E5%AE%89%E8%A3%85/nodejs.png" alt="node.js"><br>后面的默认就可以了</p><p>安装完成后，在命令行输入<code>node -v</code>，出现版本号<code>v20.5.1</code>则表示安装成功。</p><h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><p>安装<a href="https://gitforwindows.org/">git for windows</a></p><p><img src="/../../images/hexo%E5%AE%89%E8%A3%85/git.png" alt="git"><br>和上面一样，默认即可</p><p>安装完成后，在命令行输入<code>git -v</code>，出现版本号<code>git version 2.42.0</code>则表示安装成功。</p><h3 id="配置SSH"><a href="#配置SSH" class="headerlink" title="配置SSH"></a>配置SSH</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C <span class="string">&quot;你的邮箱地址&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/../../images/hexo%E5%AE%89%E8%A3%85/git_ssh.png" alt="git-ssh"><br>一直回车就可以了</p><p>然后将 <strong>id_rsa.pub</strong> 的内容复制到github的 SSH 中即可。</p><p><strong>测试ssh是否绑定成功</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#命令行中输入</span></span><br><span class="line">$ ssh -T git@github.com</span><br><span class="line"></span><br><span class="line"><span class="comment">#出现这段话表示连接成功</span></span><br><span class="line"><span class="comment">#Hi shenlan823! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h2><p><strong>一键部署</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br><span class="line">$ hexo init blog</span><br><span class="line">$ <span class="built_in">cd</span> blog</span><br><span class="line">$ npm install</span><br><span class="line">$ hexo server -p 5555</span><br></pre></td></tr></table></figure><p>在浏览器输入 <em><a href="http://localhost:5555/">http://localhost:5555</a></em> 检查是否搭建成功</p><p><img src="/../../images/hexo%E5%AE%89%E8%A3%85/hexo-example.png" alt="hexo-example"></p><h2 id="部署网站"><a href="#部署网站" class="headerlink" title="部署网站"></a>部署网站</h2><h3 id="1-安装-hexo-deployer-git"><a href="#1-安装-hexo-deployer-git" class="headerlink" title="1. 安装 hexo-deployer-git"></a>1. 安装 <a href="https://github.com/hexojs/hexo-deployer-git">hexo-deployer-git</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="2-修改配置"><a href="#2-修改配置" class="headerlink" title="2. 修改配置"></a>2. 修改配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#博客项目配置文件_config.yml(非主题配置文件)</span></span><br><span class="line">url: https://shenlan823.github.io</span><br><span class="line"></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: &lt;repository url&gt; <span class="comment">#https://bitbucket.org/JohnSmith/johnsmith.bitbucket.io</span></span><br><span class="line">  branch: [branch]</span><br></pre></td></tr></table></figure><h3 id="3-生成静态页面"><a href="#3-生成静态页面" class="headerlink" title="3. 生成静态页面"></a>3. 生成静态页面</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><h3 id="4-部署网站"><a href="#4-部署网站" class="headerlink" title="4. 部署网站"></a>4. 部署网站</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><h3 id="5-查看网站"><a href="#5-查看网站" class="headerlink" title="5. 查看网站"></a>5. 查看网站</h3><p>   在浏览器输入 <a href="https://shenlan823.github.io/">https://shenlan823.github.io</a></p><h2 id="更换模版"><a href="#更换模版" class="headerlink" title="更换模版"></a>更换模版</h2><p>以本模版为例</p><p><a href="https://hexo.io/themes/">选择模版 https://hexo.io/themes/</a></p><p>下载模版，解压到 <code>/blog/themes</code> 下，并改名 oranges。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在hexo根配置文件 _config.yml 中设置你的主题</span></span><br><span class="line">themes: oranges</span><br></pre></td></tr></table></figure><p>模版地址：<a href="https://github.com/zchengsite/hexo-theme-oranges">Oranges</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/08/24/hello-world/"/>
      <url>/2023/08/24/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
